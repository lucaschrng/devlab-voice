<!doctype html>
<head>
  <title>JavaScript Speech to Text</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <link rel="stylesheet" href="style.css">
</head>
<body>
<h2>JavaScript Speech to Text</h2>
<p>Click on the below button and speak something...</p>
<p><button type="button" onclick="runSpeechRecognition()">Speech to Text</button> &nbsp; <span id="action"></span></p>
<div id="output" class="hide"></div>

<p class="random"></p>
<div class="w-full mb-10 alphabet flex flex-col items-center gap-2 fixed bottom-0">
  <div class="flex gap-2">
    <span class="A">A</span>
    <span class="B">B</span>
    <span class="C">C</span>
    <span class="D">D</span>
    <span class="E">E</span>
    <span class="F">F</span>
    <span class="G">G</span>
    <span class="H">H</span>
    <span class="I">I</span>
  </div>
  <div class="flex gap-2">
    <span class="J">J</span>
    <span class="K">K</span>
    <span class="L">L</span>
    <span class="M">M</span>
    <span class="N">N</span>
    <span class="O">O</span>
    <span class="P">P</span>
    <span class="Q">Q</span>
    <span class="R">R</span>
  </div>
  <div class="flex gap-2">
    <span class="S">S</span>
    <span class="T">T</span>
    <span class="U">U</span>
    <span class="V">V</span>
    <span class="W">W</span>
    <span class="X">X</span>
    <span class="Y">Y</span>
    <span class="Z">Z</span>
  </div>
</div>
<script>

// random words
let randomCont = document.querySelector(".random")
fetch("https://trouve-mot.fr/api/random/2")

    .then((response) => response.json())
    .then((words) =>{

      let randomWord = words[0].name
      for(let i=0 ; i < randomWord.length ; i++){
        console.log(i)
        if(i==0){
          randomCont.innerHTML+=randomWord[0]
        }else{
          randomCont.innerHTML+=" _ "
        }
      }
    })




  /* JS comes here */
  function runSpeechRecognition() {
    // get output div reference
    var output = document.getElementById("output");
    // get action element reference
    var action = document.getElementById("action");
    // new speech recognition object
    var SpeechRecognition = SpeechRecognition || webkitSpeechRecognition;
    var recognition = new SpeechRecognition();

    // This runs when the speech recognition service starts
    recognition.onstart = function() {

      recognition.start();

      action.innerHTML = "<small>listening, please speak...</small>";
    };

    recognition.onspeechend = function() {
      console.log("end")
      action.innerHTML = "<small>stopped listening, hope you are done...</small>";
      recognition.stop();
    }

    // This runs when the speech recognition service returns result
    recognition.onresult = function(event) {
      var transcript = event.results[0][0].transcript.at(-1);
      var confidence = event.results[0][0].confidence;
      output.innerHTML = "<b>Text:</b> " + transcript + "<br/> <b>Confidence:</b> " + confidence*100+"%";
      output.classList.remove("hide");
    };

    // start recognition
    recognition.start();
  }
</script>
</body>
</html>